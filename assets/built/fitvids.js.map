{"version":3,"sources":["fitvids.js"],"names":["fitVids","postContent","options","count","settings","customSelector","ignore","document","getElementById","head","getElementsByTagName","div","createElement","childNodes","Object","keys","forEach","key","_toConsumableArray","children","node","selectors","str","push","trim","ignoreList","replace","allVideos","join","filter","some","className","includes","videoNode","parentNode","tagName","toLowerCase","getAttribute","length","classList","getComputedStyle","isNaN","setAttribute","videoContainer","height","width","parseInt","aspectRatio","parseFloat","videoName","videoWrapper","style","paddingTop","concat","add","appendChild","removeAttribute"],"mappings":"m+BAEA,IAAMA,QAAU,SAACC,EAAaC,GAC5B,IAAIC,EAAQ,EACNC,EAAW,CACfC,eAAgB,KAChBC,OAAQ,MAGV,IAAKC,SAASC,eAAe,kBAAmB,CAC9C,IAAMC,EAAOF,SAASE,MAAQF,SAASG,qBAAqB,QAAQ,GATxEC,EAAAJ,SAAAK,cAAA,OACMZ,EAAAA,UAAU,oUACdS,EAAIN,YAAJQ,EAAAE,WAAA,IAGEP,GAFFQ,OAAAC,KAAAb,GAAAc,QAAA,SAAAC,GAiBIb,EAASa,GAAOf,EAAQe,KARxBC,mBAAAjB,EAAAkB,UAAAH,QAAA,SAAAI,GACF,IAAMT,EAAc,CACpBA,kCACAF,6BACD,sCAaG,oDAXAP,qCACFY,SACEV,SAeEA,EAASC,gBAXfD,EAAAC,eACQgB,MAAAA,KAaDL,QAAQ,SAACM,GAAD,OAASD,EAAUE,KAAKD,EAAIE,UAA5B,IAAAC,EAASJ,CAAAA,iBACrBjB,EAAAE,QAKCF,EAASE,OAHPmB,MAAAA,KAKCT,QAAQ,SAACM,GAAD,OAASG,EAAWF,KAAKD,EAAII,QAAQ,IAAK,IAAIF,UAA9C,IAAAG,EAASF,mBAAAA,EAAWF,iBAAKF,EAAAO,KAAzB,QACZD,GADYA,EAFXA,EAAAE,OAAA,SAAAT,GAAA,MAAA,kBAAAA,KAGDS,OAKC,SAACT,GAAD,OAAWK,EAAWK,KAAK,SAACR,GAAD,OAASF,EAAKW,UAAUC,SAASV,QAFrDN,QAAGW,SAAAA,GAAiB,IAA7BF,EAAAK,KAAA,SAAAR,GAAA,OAAAW,EAAAC,WAAAH,UAAAC,SAAAV,QAGG,UAAAW,EAAAE,QAAAC,eAUGH,EAAUC,WAAWG,aAAa,UAAUC,QARlDX,EAAUX,WAAQuB,UAACN,SAAc,8BAHJ,CAQ1BO,iBAAAP,GAAA,QAUEO,iBAAiBP,GAAjB,QATHQ,MACGR,EAAUE,aAAQC,aAInBK,MAAAR,EAAAI,aAAA,YAQAJ,EAAUS,aAAa,SAAU,GANnCT,EACGO,aAAiBP,QAAW,KAO9B,IAwBDU,GArBwC,WAApCV,EAAUE,QAAQC,eADlBQ,EACAX,aAAUE,YAOZU,MAASJ,SAAMK,EAASb,aAAUI,UAAa,KAK/CU,SAAWd,EAAYY,aAbzB,UAAA,IAKQG,WAUHf,iBAAAA,EAAgC,MAAAW,OAAAlB,QAAA,KAAA,OAE1Be,MAACC,SAAaT,EAAQgB,aAA/B,SAAA,KAEDD,WAROR,iBAAiBP,EAAW,MAAMY,MAAMnB,QAAQ,KAAM,KAO5DvB,SAAK8B,EAAAI,aAAA,SAAA,KAOPa,IAAAA,EAAaC,aAAMC,QAAnB,CACAF,IAAAA,EAAaX,SAAcpC,EATzB8B,EAAUS,aAAa,OAAQO,GAYjChB,IAIA,IAAIA,EAAUI,SAAazB,cAAWqB,OACtCU,EAAcN,UAAAA,IAAa,+BAxF/B,IAAAa,EAAA3C,SAAAK,cAAA,OAvBFsC,EAAAC,MAAAC,WAAA,GAAAC,OAAA,IAAAN,EAAA,KAuGMG,EAAaX,UAAUe,IAAI,6BAG3BrB,EAAUC,WAAWqB,YAAYZ,GACjCA,EAAeY,YAAYL,GAC3BA,EAAaK,YAAYtB,GAErBA,EAAUI,aAAa,WAAWJ,EAAUuB,gBAAgB,UAC5DvB,EAAUI,aAAa,UAAUJ,EAAUuB,gBAAgB","file":"fitvids.js","sourcesContent":["/* eslint-disable no-unused-vars */\n/* eslint-disable no-inline-comments */\nconst fitVids = (postContent, options) => {\n  let count = 0;\n  const settings = {\n    customSelector: null,\n    ignore: null\n  };\n\n  if (!document.getElementById('fit-vids-style')) {\n    const head = document.head || document.getElementsByTagName('head')[0];\n    const css =\n      // eslint-disable-next-line max-len\n      '.fluid-width-video-container{flex-grow: 1;width:100%;}.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}';\n    const div = document.createElement('div');\n    div.innerHTML = '<p>x</p><style id=\"fit-vids-style\">' + css + '</style>';\n    head.appendChild(div.childNodes[1]);\n  }\n\n  if (options) {\n    Object.keys(options).forEach((key) => {\n      settings[key] = options[key];\n    });\n  }\n\n  [...postContent.children].forEach((node) => {\n    const selectors = [\n      'iframe[src*=\"player.vimeo.com\"]',\n      'iframe[src*=\"youtube.com\"]',\n      'iframe[src*=\"youtube-nocookie.com\"]',\n      'iframe[src*=\"kickstarter.com\"][src*=\"video.html\"]',\n      'iframe[src*=\"player.bilibili.com\"]',\n      'object',\n      'embed'\n    ];\n\n    if (settings.customSelector) {\n      settings.customSelector\n        .split(',')\n        .forEach((str) => selectors.push(str.trim()));\n    }\n\n    let ignoreList = ['fitvidsignore'];\n\n    if (settings.ignore) {\n      settings.ignore\n        .split(',')\n        .forEach((str) => ignoreList.push(str.replace('.', '').trim()));\n    }\n\n    let allVideos = [...node.querySelectorAll(selectors.join(','))];\n    allVideos = allVideos.filter((node) => node !== 'object object');\n    allVideos = allVideos.filter(\n      (node) => !ignoreList.some((str) => node.className.includes(str))\n    ); // Disable FitVids on this video\n\n    allVideos.forEach((videoNode) => {\n      if (\n        ignoreList.some((str) => videoNode.parentNode.className.includes(str))\n      ) {\n        return; // Disable FitVids on this video\n      }\n      if (\n        (videoNode.tagName.toLowerCase() === 'embed' &&\n          videoNode.parentNode.getAttribute('object').length) ||\n        videoNode.parentNode.classList.contains('fluid-width-video-wrapper')\n      ) {\n        return;\n      }\n      if (\n        !getComputedStyle(videoNode)['height'] &&\n        !getComputedStyle(videoNode)['width'] &&\n        (isNaN(videoNode.getAttribute('height')) ||\n          isNaN(videoNode.getAttribute('width')))\n      ) {\n        videoNode.setAttribute('height', 9);\n        videoNode.setAttribute('width', 16);\n      }\n\n      let height =\n          videoNode.tagName.toLowerCase() === 'object' ||\n          (videoNode.getAttribute('height') &&\n            !isNaN(parseInt(videoNode.getAttribute('height'), 10)))\n            ? parseInt(videoNode.getAttribute('height'), 10)\n            : parseFloat(\n                getComputedStyle(videoNode, null).height.replace('px', '')\n              ),\n        width = !isNaN(parseInt(videoNode.getAttribute('width'), 10))\n          ? parseInt(videoNode.getAttribute('width'), 10)\n          : parseFloat(\n              getComputedStyle(videoNode, null).width.replace('px', '')\n            ),\n        aspectRatio = height / width;\n\n      if (!videoNode.getAttribute('name')) {\n        const videoName = 'fitvid' + count;\n        videoNode.setAttribute('name', videoName);\n        count++;\n      }\n\n      const videoContainer = document.createElement('div');\n      videoContainer.classList.add('fluid-width-video-container');\n\n      const videoWrapper = document.createElement('div');\n      videoWrapper.style.paddingTop = `${aspectRatio * 100}%`;\n      videoWrapper.classList.add('fluid-width-video-wrapper');\n\n      // Append wrappers and video to page\n      videoNode.parentNode.appendChild(videoContainer);\n      videoContainer.appendChild(videoWrapper);\n      videoWrapper.appendChild(videoNode);\n\n      if (videoNode.getAttribute('height')) videoNode.removeAttribute('height');\n      if (videoNode.getAttribute('width')) videoNode.removeAttribute('width');\n    });\n  });\n};\n"]}