{"version":3,"file":"infinitescroll.js","sources":["infinitescroll.js"],"sourcesContent":["/**\n * Infinite Scroll\n */\n\n(function(window, document) {\n    // next link element\n\n    var nextElement = document.querySelector(\"link[rel=next]\");\n    if (!nextElement) return;\n\n    // post feed element\n    var feedElement = document.querySelector(\".post-feed\");\n    if (!feedElement) return;\n\n    var loading = false;\n\n    function onPageLoad() {\n        if (this.status === 404) {\n            document\n                .getElementById(\"readMoreBtn\")\n                .removeEventListener(\"click\", onUpdate);\n            return;\n        }\n        // append contents\n        var postElements = this.response.querySelectorAll(\".post-card\");\n        postElements.forEach(function(item) {\n            feedElement.appendChild(item);\n        });\n\n        // set next link\n        var resNextElement = this.response.querySelector(\"link[rel=next]\");\n        if (resNextElement) {\n            nextElement.href = resNextElement.href;\n        } else {\n            document\n                .getElementById(\"readMoreBtn\")\n                .removeEventListener(\"click\", onUpdate);\n        }\n\n        // sync status\n        loading = false;\n    }\n\n    function onUpdate() {\n        // return if already loading\n        if (loading) return;\n\n        loading = true;\n\n        var xhr = new window.XMLHttpRequest();\n        xhr.responseType = \"document\";\n\n        xhr.addEventListener(\"load\", onPageLoad);\n\n        xhr.open(\"GET\", nextElement.href);\n        xhr.send(null);\n    }\n\n    document\n        .getElementById(\"readMoreBtn\")\n        .addEventListener(\"click\", onUpdate, { passive: true });\n})(window, document);\n"],"names":["window","document","feedElement","loading","nextElement","querySelector","onPageLoad","resNextElement","this","status","response","querySelectorAll","forEach","item","appendChild","href","getElementById","removeEventListener","onUpdate","xhr","XMLHttpRequest","responseType","addEventListener","open","send","passive"],"mappings":"CAIA,SAAUA,EAAQC,GAGd,IAIIC,EAGAC,EAPAC,EAAcH,EAASI,cAAc,kBASzC,SAASC,IACL,IAaIC,EAbgB,MAAhBC,KAAKC,QAOUD,KAAKE,SAASC,iBAAiB,cACrCC,QAAQ,SAASC,GAC1BX,EAAYY,YAAYD,MAIxBN,EAAiBC,KAAKE,SAASL,cAAc,mBAE7CD,EAAYW,KAAOR,EAAeQ,KAElCd,EACKe,eAAe,eACfC,oBAAoB,QAASC,GAItCf,GAAU,GAtBNF,EACKe,eAAe,eACfC,oBAAoB,QAASC,GAuB1C,SAASA,IAEL,IAIIC,EAJAhB,IAEJA,GAAU,GAENgB,EAAM,IAAInB,EAAOoB,gBACjBC,aAAe,WAEnBF,EAAIG,iBAAiB,OAAQhB,GAE7Ba,EAAII,KAAK,MAAOnB,EAAYW,MAC5BI,EAAIK,KAAK,QA/CRpB,IAGDF,EAAcD,EAASI,cAAc,iBAGrCF,GAAU,EA4CdF,EACKe,eAAe,eACfM,iBAAiB,QAASJ,EAAU,CAAEO,SAAS,KAxDxD,CAyDGzB,OAAQC"}