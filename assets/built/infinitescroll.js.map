{"version":3,"file":"infinitescroll.js","sources":["infinitescroll.js"],"sourcesContent":["/**\n * Infinite Scroll\n */\n\n(function (window, document) {\n  // next link element\n  var nextElement = document.querySelector('link[rel=next]');\n  if (!nextElement) {\n    document.querySelector('.read-more-row').remove();\n    return;\n  }\n\n  // post feed element\n  var feedElement = document.querySelector('.post-feed');\n  if (!feedElement) return;\n\n  var loading = false;\n\n  function onPageLoad() {\n    if (this.status === 404) {\n      document\n        .getElementById('readMoreBtn')\n        .removeEventListener('click', onUpdate);\n      return;\n    }\n    // append contents\n    var postElements = this.response.querySelectorAll('.post-card');\n    postElements.forEach(function (item) {\n      feedElement.appendChild(item);\n    });\n\n    // set next link\n    var resNextElement = this.response.querySelector('link[rel=next]');\n    if (resNextElement) {\n      nextElement.href = resNextElement.href;\n    } else {\n      document\n        .getElementById('readMoreBtn')\n        .removeEventListener('click', onUpdate);\n      document.querySelector('.read-more-row').remove();\n    }\n\n    // sync status\n    loading = false;\n  }\n\n  function onUpdate() {\n    // return if already loading\n    if (loading) return;\n\n    loading = true;\n\n    var xhr = new window.XMLHttpRequest();\n    xhr.responseType = 'document';\n\n    xhr.addEventListener('load', onPageLoad);\n\n    xhr.open('GET', nextElement.href);\n    xhr.send(null);\n  }\n\n  document\n    .getElementById('readMoreBtn')\n    .addEventListener('click', onUpdate, { passive: true });\n})(window, document);\n"],"names":["window","document","nextElement","querySelector","feedElement","loading","getElementById","addEventListener","onUpdate","passive","remove","onPageLoad","this","status","response","querySelectorAll","forEach","item","appendChild","resNextElement","href","removeEventListener","xhr","XMLHttpRequest","responseType","open","send"],"mappings":"CAIA,SAAWA,EAAQC,GAEjB,IAAIC,EAAcD,EAASE,cAAc,kBACzC,GAAKD,EAAL,CAMA,IAAIE,EAAcH,EAASE,cAAc,cACzC,GAAKC,EAAL,CAEA,IAAIC,GAAU,EA6CdJ,EACGK,eAAe,eACfC,iBAAiB,QAASC,EAAU,CAAEC,SAAS,UAvDhDR,EAASE,cAAc,kBAAkBO,SAU3C,SAASC,IACP,GAAoB,MAAhBC,KAAKC,OAAT,CAOmBD,KAAKE,SAASC,iBAAiB,cACrCC,QAAQ,SAAUC,GAC7Bb,EAAYc,YAAYD,KAI1B,IAAIE,EAAiBP,KAAKE,SAASX,cAAc,kBAC7CgB,EACFjB,EAAYkB,KAAOD,EAAeC,MAElCnB,EACGK,eAAe,eACfe,oBAAoB,QAASb,GAChCP,EAASE,cAAc,kBAAkBO,UAI3CL,GAAU,OAvBRJ,EACGK,eAAe,eACfe,oBAAoB,QAASb,GAwBpC,SAASA,IAEP,IAAIH,EAAJ,CAEAA,GAAU,EAEV,IAAIiB,EAAM,IAAItB,EAAOuB,eACrBD,EAAIE,aAAe,WAEnBF,EAAIf,iBAAiB,OAAQI,GAE7BW,EAAIG,KAAK,MAAOvB,EAAYkB,MAC5BE,EAAII,KAAK,QAtDb,CA4DG1B,OAAQC"}